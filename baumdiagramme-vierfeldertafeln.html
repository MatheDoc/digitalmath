<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Interaktives Plotly Baumdiagramm</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link rel="stylesheet" href="styles.css"> 
  <script>
    window.MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="js_tools/baumdiagramm.js"></script>
<style>
table.diagramm th,
table.diagramm td {
    text-align: center;
    vertical-align: middle;
}
.diagramm-row {
  display: flex;
  gap: 10px; /* Abstand zwischen den Elementen */
  justify-content: center;
  align-items: flex-start;
  flex-wrap: wrap; /* Optional: Zeilenumbruch auf kleinen Bildschirmen */
}

</style>
</head>
<body>
      <header>
      <a href="https://mathedoc.github.io/digitalmath/index" class="link-homepage" title="home">
        <h1>MatheChecks</h1>
      </a>
      <h2>Baumdiagramm, inverses Baumdiagramm und Vier-Felder-Tafel</h2>
    </header>
<main>
<div>
  <label>$P(A) = $ <span id="paWert">0.50</span></label><br>
  <input type="range" id="paSlider" min="0" max="1" step="0.01" value="0.5"><br><br>

  <label>$P_A(B) = $ <span id="pbaWert">0.10</span></label><br>
  <input type="range" id="pbaSlider" min="0" max="1" step="0.01" value="0.1"><br><br>

  <label>$P_{\overline{A}}(B) = $ <span id="pbnaWert">0.30</span></label><br>
  <input type="range" id="pbnaSlider" min="0" max="1" step="0.01" value="0.3"><br><br>
  <div id="unabhaengigkeitText" style="margin-top:10px; font-weight:bold;"></div>
</div>

<div class="diagramm-row">
  
  <div id="baum" class="diagramm"></div>
  
  <div id="invers" class="diagramm"></div>

  <table class="diagramm" border="1" cellspacing="0" cellpadding="5">
  
    <thead>
      <tr>
        <th></th>
        <th>\( B \)</th>
        <th>\( \overline{B} \)</th>
        <th>\( \Sigma \)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>\( A \)</td>
        <td id="cell_a_b"></td>
        <td id="cell_a_nb"></td>
        <td id="cell_a_sum"></td>
      </tr>
      <tr>
        <td>\( \overline{A} \)</td>
        <td id="cell_na_b"></td>
        <td id="cell_na_nb"></td>
        <td id="cell_na_sum"></td>
      </tr>
      <tr>
        <td>\( \Sigma \)</td>
        <td id="cell_sum_b"></td>
        <td id="cell_sum_nb"></td>
        <td id="cell_sum_sum"></td>
      </tr>
    </tbody>
  </table>
</div>

</main>

<script>
  // Event-Handler für Inputs
  function updateFromInputs() {
  const pa = parseFloat(document.getElementById('paSlider').value);
  const pba = parseFloat(document.getElementById('pbaSlider').value);
  const pbna = parseFloat(document.getElementById('pbnaSlider').value);

  document.getElementById('paWert').innerText = pa.toFixed(2);
  document.getElementById('pbaWert').innerText = pba.toFixed(2);
  document.getElementById('pbnaWert').innerText = pbna.toFixed(2);

  zeichneBaumdiagramm(pa, pba, pbna, 'baum', 'Baumdiagramm');
  const pb = pa * pba + (1 - pa) * pbna;
  const pab = pa * pba / pb;
  const panb = pa * (1 - pba) / (1 - pb);
  zeichneBaumdiagramm(pb, pab, panb, 'invers', 'Inverses Baumdiagramm', 'B', 'B\u0305', 'A', 'A\u0305');

  // Vierfeldertafel berechnen
  const a_b = pa * pba;
  const a_nb = pa * (1 - pba);
  const na_b = (1 - pa) * pbna;
  const na_nb = (1 - pa) * (1 - pbna);

  // Zellen füllen
  document.getElementById('cell_a_b').innerText = a_b.toFixed(4).replace('.', ',');
  document.getElementById('cell_a_nb').innerText = a_nb.toFixed(4).replace('.', ',');
  document.getElementById('cell_na_b').innerText = na_b.toFixed(4).replace('.', ',');
  document.getElementById('cell_na_nb').innerText = na_nb.toFixed(4).replace('.', ',');

  // Randsummen
  document.getElementById('cell_a_sum').innerText = (a_b + a_nb).toFixed(2).replace('.', ',');
  document.getElementById('cell_na_sum').innerText = (na_b + na_nb).toFixed(2).replace('.', ',');
  document.getElementById('cell_sum_b').innerText = (a_b + na_b).toFixed(2).replace('.', ',');
  document.getElementById('cell_sum_nb').innerText = (a_nb + na_nb).toFixed(2).replace('.', ',');
  document.getElementById('cell_sum_sum').innerText = '1';

  // Unabhängigkeitstext aktualisieren
  const unabhaengig = Math.abs(pba - pbna) < 1e-6;
  document.getElementById('unabhaengigkeitText').innerText =
    unabhaengig
      ? "A und B sind stochastisch unabhängig."
      : "A und B sind stochastisch abhängig.";
}

  // Inputs mit Handler verbinden
  document.getElementById('paSlider').addEventListener('input', updateFromInputs);
  document.getElementById('pbaSlider').addEventListener('input', updateFromInputs);
  document.getElementById('pbnaSlider').addEventListener('input', updateFromInputs);

  // Mausradsteuerung für alle Slider aktivieren
  ['paSlider', 'pbaSlider', 'pbnaSlider'].forEach(id => {
    const slider = document.getElementById(id);
    slider.addEventListener('wheel', function(e) {
      e.preventDefault();
      const step = parseFloat(slider.step) || 0.01;
      let value = parseFloat(slider.value);
      if (e.deltaY < 0) {
        value = Math.min(parseFloat(slider.max), value + step);
      } else {
        value = Math.max(parseFloat(slider.min), value - step);
      }
      slider.value = value.toFixed(2);
      slider.dispatchEvent(new Event('input'));
    });
  });

  // Initiales Diagramm
  updateFromInputs();
</script>
</body>
</html>